\section{Basis Propagation}

Message Passing of directed and boolean message by basis encoding of functions can be interpreted as function evaluation.
Each subfunction evaluation is passed in its one-hot encoding.

This is because any basis encoding of a function, the decomposition
\begin{align*}
	\bencodingof{\exfunction} = \sum_{y \in\imageof{\exfunction}} ( \sum_{i: \exfunction(i)=y}\onehotmapof{i} )  \otimes \onehotmapof{y}
\end{align*}
is a SVD of the matrification of $\bencodingof{\exfunction}$ with respect to incoming and outgoing legs.


Passing a message $\onehotmapof{i}$ in direction thus gives the message $\onehotmapof{\exfunction(i)}$.

Note, that this is exact, whenever the graph is directed and acyclic.
We do not need acyclicity of the underlying undirected graph.
\red{Make a theorem!}

\red{
Distinguish:
\begin{itemize}
    \item Single inference: Basis propagation
    \item Batchwise inference: "Tensor Parallelism", but in the most interesting cases not exact.
\end{itemize}
}

%After having established a one-to-one connection between the directed and binary tensors with the encoding of functions, we now interpret contractions as evaluations of the respective functions.
%Applying this insight iteratively on composed functions we show the following theorem.

\begin{remark}[Basis Calculus as Message Passing]
	Given a tensor network of directed and binary tensor cores, each representing a function $\exfunctionof{\edge}$ depending on variables $\incomingnodes$.
	When there are not directed cycles, we define the compositions of $\exfunctionof{\edge}$ to be the function $\exfunction$ from the nodes $\nodesone$ not appearing as incoming nodes to the nodes $\nodestwo$ not appearing as outgoing nodes in an edge.
	Choosing arbitrary $\catindexof{\node}\in[\catdimof{\node}]$ for $\node\in\nodesone$ we have
	\begin{align*}
		\contractionof{\{\bencodingofat{\exfunctionof{\edge}}{\catvariableof{\outgoingnodes},\catvariableof{\incomingnodes}} \, : \edge=(\outgoingnodes,\incomingnodes)\in\edges\}}{\nodestwo}
	= \onehotmapof{\exfunction(\catindexof{\node} \wcols \node\in\nodesone)}\, .
	\end{align*}
\end{remark}

