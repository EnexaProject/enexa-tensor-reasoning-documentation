\documentclass[aps,onecolumn,nofootinbib,pra]{article}

\usepackage{../../article_compilation/spec_files/arxiv}
\input{../../article_compilation/spec_files/standard_preamble.tex}

\input{../../macros/organization_macros.tex}
\input{../../macros/general_macros.tex}
\input{../../macros/tc_macros.tex}
\input{../../macros/tikz_macros.tex}

\begin{document}
    \title{Characterization of \ComputationActivationNetworks{} by sufficient statistics}

    \maketitle
    \date{\today}

%    \tableofcontents

    \section{Sufficient Statistic for Parametrized Families}

    Sufficient statistics are treated in mathematical statistics and in information theory.
    We here choose a definition of information theory and apply a factorization theorem of mathematical statistics to relate with \ComputationActivationNetworks{}.
    The distribution of a canonical parameter is now drawn from a (possibly continuous) random variable $\Theta$, which takes values $\theta\in\Gamma$ with probability
    \begin{align*}
        \secprobat{\Theta=\theta} \, .
    \end{align*}
    
    \begin{definition}[Sufficient statistics for Parameters]
        Let $\{\probofat{\theta}{\shortcatvariables}\wcols\theta\in\Gamma\}$ be a family of probability distributions and
        \begin{align*}
            \sstat\defcols\facstates\rightarrow\bigtimes_{\selindexin}[\seldimof{\selindex}]
        \end{align*}
        be a function.
        We say that $\sstat$ is sufficient for $\Theta$, if for any distribution $\secprobat{\Theta}$ of $\Theta$, when drawing $\shortcatvariables$ from $\probofat{\theta}{\shortcatvariables}$ with probability $\secprobat{\Theta=\theta}$, we have that
        \begin{align*}
            \condindependent{\Theta}{\shortcatvariables}{\sstatat{\shortcatvariables}} \, .
        \end{align*}
    \end{definition}



    \begin{theorem}[Characterization of \ComputationActivationNetworks{}]
        Let $\{\probofat{\theta}{\shortcatvariables}\wcols\theta\in\Gamma\}$ be a family of probability distributions with a sufficient statistic $\sstat$.
        Then there is a non-negative (possibly non-Boolean) base measure $\basemeasurewith$ and a map
        \begin{align*}
            h : \Gamma \rightarrow \bigotimes_{\selindexin} \rr^{\seldimof{\selindex}}
        \end{align*}
        such that for all $\theta\in\Gamma$
        \begin{align*}
            \probofat{\theta}{\shortcatvariables}
            = \normalizationof{h(\Gamma)[\headvariables],\bencsstatwith,\basemeasurewith}{\shortcatvariables} \, .
        \end{align*}
        We further have that for a set $\{\probofat{\theta}{\shortcatvariables}\wcols\theta\in\Gamma\}$ $\sstat$ is a sufficient statistic, if and only if there is a non-negative (possibly non-Boolean) base measure $\basemeasurewith$ with
        \begin{align*}
            \{\probofat{\theta}{\shortcatvariables}\wcols\theta\in\Gamma\}
            \subset \realizabledistsof{\sstat,\maxgraph,\basemeasure} \, .
        \end{align*}
    \end{theorem}
    \begin{proof}
        By the factorization theorem of mathematical statistics (see [Hogg - The. 2.7.1]) we have that $\sstat$ is a sufficient statistic if and only if there are real-valued functions $k_1$ on $\left(\bigtimes_{\selindexin}[\seldimof{\selindex}]\right)\times \Gamma$ and $k_2$ on $\facstates$ such that
        \begin{align}\label{eq:conFactorizationSufStat}
            \probofat{\theta}{\indexedshortcatvariables}
            = k_1(\sstatof{\shortcatindices},\Gamma) \cdot k_2(\shortcatindices) \, .
        \end{align}
        We define a base measure by the coordinate encoding of $k_2$ by
        \begin{align*}
            \basemeasureat{\shortcatvariables} = \sum_{\shortcatindicesin} k_2(\shortcatindices) \onehotmapofat{\shortcatindices}{\shortcatvariables}
        \end{align*}
        and for each $\theta\in\Gamma$ an activation tensor
        \begin{align*}
            \acttensorofat{\theta}{\headvariables} = \sum_{\shortheadindices} k_1(\shortheadindices,\theta) \onehotmapofat{\shortheadindices}{\headvariables} \, .
        \end{align*}
        With this we have for any $\theta\in\Gamma$
        \begin{align*}
            \contraction{h(\Gamma)[\headvariables],\bencsstatwith,\basemeasurewith} = 1
        \end{align*}
        and thus for any $\shortcatindicesin$ applying basis calculus
        \begin{align*}
            \normalizationof{h(\Gamma)[\headvariables],\bencsstatwith,\basemeasurewith}{\indexedshortcatvariables}
            &= h(\Gamma)[\headvariables=\sstatof{\shortcatindices}] \cdot \basemeasureat{\indexedshortcatvariables} \\
            &= k_1(\sstatof{\shortcatindices},\Gamma) \cdot k_2(\shortcatindices) \\
            &= \probofat{\theta}{\indexedshortcatvariables}
            \, .
        \end{align*}
        We therefore find for any $\probofat{\theta}{\shortcatvariables}$ a representation as a \ComputationActivationNetwork{} in $\realizabledistsof{\sstat,\maxgraph,\basemeasure}$ with the activation tensor $h(\Gamma)[\headvariables]$.

        To show the second claim, we are left to show that any set of \ComputationActivationNetworks{} in $\realizabledistsof{\sstat,\maxgraph,\basemeasure}$ has $\sstat$ as a sufficient statistic.
        Let us thus consider a parametric family
        \begin{align*}
            \{\probofat{\theta}{\shortcatvariables}\wcols\theta\in\Gamma\}
            \subset \realizabledistsof{\sstat,\maxgraph,\basemeasure} \, .
        \end{align*}
        By this inclusion we find for any $\theta\in\Gamma$ an activation core $\actcoreofat{\theta}{\headvariables}$.
        We then construct functions $k_1$ and $k_2$ by
        \begin{align*}
            k_1(\shortheadindices,\Gamma) = \actcoreofat{\theta}{\indexedheadvariableof{[\seldim]}}
            \andspace
            k_2(\shortcatindices) = \basemeasureat{\indexedshortcatvariables}
        \end{align*}
        and notice that the equivalent condition \eqref{eq:conFactorizationSufStat} to $\sstat$ being a sufficient statistic is satisfied.
    \end{proof}
    
    \section{Sufficient Statistic for the Probability}
    
        % Compare with report version
    We here consider sufficient statistics for the parameter of a parametrized family, while in the report we considered sufficient statistics for the probability mass as a random variable.
    In both cases this results from the information theoretic viewpoint, that a function $T$ of $X$ is a sufficient statistic for a variable $Z$, if
    \begin{align*}
        \condindependent{Z}{X}{T(X)} \, .
    \end{align*}
    While we choose for $Z$ $\headvariableof{\theta}$ above, we now choose for $Z$ the variable $\headvariableof{\probtensor}$.
    This variable can be computed by contraction with
    \begin{align*}
        \bencodingofat{\probtensor}{\headvariableof{\probtensor},\shortcatvariables} \, .
    \end{align*}
    If $T$ is a sufficient statistic for $\headvariableof{\probtensor}$, we call it probability sufficient for $\probtensor$.

    \begin{theorem}[Theorem 2.19 in the report]
        If and only if a statistic $\sstat$ is probability sufficient for $\probwith$, then
        \begin{align*}
            \probwith \in \realizabledistsof{\sstat,\maxgraph,\trivbm} \, .
        \end{align*}
    \end{theorem}

    Note that by this theorem w can restrict ourselves to the \ComputationActivationNetworks{} with trivial base measure for the characterization of distributions with a probability sufficient statistic.
    
\end{document}