\documentclass[aps,onecolumn,nofootinbib,pra]{article}

\usepackage{../../article_compilation/spec_files/arxiv}
\input{../../article_compilation/spec_files/standard_preamble.tex}

\input{../../macros/organization_macros.tex}
\input{../../macros/general_macros.tex}
\input{../../macros/tc_macros.tex}
\input{../../macros/tikz_macros.tex}

\begin{document}
    \title{Characterization of \ComputationActivationNetworks{} by sufficient statistics}

    \maketitle
    \date{\today}

%    \tableofcontents

    Sufficient statistics are treated in mathematical statistics and in information theory.
    We here choose a definition of information theory and apply a factorization theorem of mathematical statistics to relate with \ComputationActivationNetworks{}.

    \begin{definition}[Sufficient statistics]
        Let $\{\probofat{\canparam}{\shortcatvariables}\wcols\canparam\in\Theta\}$ be a family of probability distributions and
        \begin{align*}
            \sstat\defcols\facstates\rightarrow\bigtimes_{\selindexin}[\seldimof{\selindex}]
        \end{align*}
        be a function.
        We say that $\sstat$ is sufficient for $\canparam$, if for any distribution $\secprobat{\canparam}$ of $\canparam$, when drawing $\shortcatvariables$ from $\probofat{\canparam}{\shortcatvariables}$ with probability $\secprobat{\canparam}$, we have that
        \begin{align*}
            \condindependent{\canparam}{\shortcatvariables}{\sstatat{\shortcatvariables}} \, .
        \end{align*}
    \end{definition}



    \begin{theorem}[Characterization of \ComputationActivationNetworks{}]
        Let $\{\probofat{\canparam}{\shortcatvariables}\wcols\canparam\in\Theta\}$ be a family of probability distributions with a sufficient statistic $\sstat$.
        Then there is a non-negative (possibly non-Boolean) base measure $\basemeasurewith$ and a map
        \begin{align*}
            h : \Theta \rightarrow \bigotimes_{\selindexin} \rr^{\seldimof{\selindex}}
        \end{align*}
        such that for all $\canparam\in\Theta$
        \begin{align*}
            \probofat{\canparam}{\shortcatvariables}
            = \normalizationof{h(\theta)[\headvariables],\bencsstatwith,\basemeasurewith}{\shortcatvariables} \, .
        \end{align*}
        We further have that for a set $\{\probofat{\canparam}{\shortcatvariables}\wcols\canparam\in\Theta\}$ $\sstat$ is a sufficient statistic, if and only if there is a non-negative (possibly non-Boolean) base measure $\basemeasurewith$ with
        \begin{align*}
            \{\probofat{\canparam}{\shortcatvariables}\wcols\canparam\in\Theta\}
            \subset \realizabledistsof{\sstat,\maxgraph,\basemeasure} \, .
        \end{align*}
    \end{theorem}
    \begin{proof}
        By the factorization theorem of mathematical statistics (see [Hogg - The. 2.7.1]) we have that $\sstat$ is a sufficient statistic if and only if there are real-valued functions $k_1$ on $\left(\bigtimes_{\selindexin}[\seldimof{\selindex}]\right)\times \Theta$ and $k_2$ on $\facstates$ such that
        \begin{align}\label{eq:conFactorizationSufStat}
            \probofat{\canparam}{\indexedshortcatvariables}
            = k_1(\sstatof{\shortcatindices},\theta) \cdot k_2(\shortcatindices) \, .
        \end{align}
        We define a base measure by the coordinate encoding of $k_2$ by
        \begin{align*}
            \basemeasureat{\shortcatvariables} = \sum_{\shortcatindicesin} k_2(\shortcatindices) \onehotmapofat{\shortcatindices}{\shortcatvariables}
        \end{align*}
        and for each $\canparam\in\Theta$ an activation tensor
        \begin{align*}
            \acttensorofat{\canparam}{\headvariables} = \sum_{\shortheadindices} k_1(\shortheadindices,\canparam) \onehotmapofat{\shortheadindices}{\headvariables} \, .
        \end{align*}
        With this we have for any $\canparam\in\Theta$
        \begin{align*}
            \contraction{h(\theta)[\headvariables],\bencsstatwith,\basemeasurewith} = 1
        \end{align*}
        and thus for any $\shortcatindicesin$ applying basis calculus
        \begin{align*}
            \normalizationof{h(\theta)[\headvariables],\bencsstatwith,\basemeasurewith}{\indexedshortcatvariables}
            &= h(\theta)[\headvariables=\sstatof{\shortcatindices}] \cdot \basemeasureat{\indexedshortcatvariables} \\
            &= k_1(\sstatof{\shortcatindices},\theta) \cdot k_2(\shortcatindices) \\
            &= \probofat{\canparam}{\indexedshortcatvariables}
            \, .
        \end{align*}
        We therefore find for any $\probofat{\canparam}{\shortcatvariables}$ a representation as a \ComputationActivationNetwork{} in $\realizabledistsof{\sstat,\maxgraph,\basemeasure}$ with the activation tensor $h(\theta)[\headvariables]$.

        To show the second claim, we are left to show that any set of \ComputationActivationNetworks{} in $\realizabledistsof{\sstat,\maxgraph,\basemeasure}$ has $\sstat$ as a sufficient statistic.
        Let us thus consider a parametric family
        \begin{align*}
            \{\probofat{\canparam}{\shortcatvariables}\wcols\canparam\in\Theta\}
            \subset \realizabledistsof{\sstat,\maxgraph,\basemeasure} \, .
        \end{align*}
        By this inclusion we find for any $\canparam\in\Theta$ an activation core $\actcoreofat{\canparam}{\headvariables}$.
        We then construct functions $k_1$ and $k_2$ by
        \begin{align*}
            k_1(\shortheadindices,\theta) = \actcoreofat{\canparam}{\indexedheadvariableof{[\seldim]}}
            \andspace
            k_2(\shortcatindices) = \basemeasureat{\indexedshortcatvariables}
        \end{align*}
        and notice that the equivalent condition \eqref{eq:conFactorizationSufStat} to $\sstat$ being a sufficient statistic is satisfied.
    \end{proof}
    
\end{document}