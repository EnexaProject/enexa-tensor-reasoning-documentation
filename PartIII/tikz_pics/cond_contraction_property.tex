\begin{tikzpicture}[scale=0.3, thick] % , baseline = -3.5pt


\draw[dashed] (-22,1) rectangle (-14,3); 
\node[anchor=center] (text) at (-18,2) {\small $\ones$};

\draw[->]  (-21,-1)--(-21,1);% node[midway,left] {\tiny $\node_1$}; 
\draw[->]  (-15,-1)--(-15,1);% node[midway,left] {\tiny $\cdots \quad \edge^{out}_1$}; 
\node[anchor=center] (text) at (-18,0) {\small $\cdots$};


\draw (-18,0) ellipse (4 and 0.5);
\node[anchor=center] (text) at (-23,0) {\tiny $\edge^{out}_1$};

\draw (-22,-1) rectangle (-14,-3);
\node[anchor=center] (text) at (-18,-2) {\small $\hypercoreof{\edge_1}$};
\draw[<-]  (-21,-3)--(-21,-5);% node[midway,left]% {\tiny $\node_1$}; 
\draw[<-]  (-19,-3)--(-19,-5) node[midway,left] {\tiny $\cdots$}; 

\draw[<-]  (-17,-3)--(-17,-7);% node[midway,left] {\tiny $\exrandom$}; 
\draw[<-]  (-15,-3)--(-15,-5) node[midway,left] {\tiny $\cdots$};% node[midway,left] {\tiny $\exrandom$}; 
\draw (-15,-5) -- (-15,-7);

\draw (-18,-4) ellipse (4 and 0.5);
\node[anchor=center] (text) at (-23,-4) {\tiny $\edge^{in}_1$};


\draw[dashed] (-18.5,-5) rectangle (-22,-7); 
\node[anchor=center] (text) at (-20.25,-6) {\small $\onehotmapof{\catindex}$};

\draw (-13.5,-6) ellipse (4 and 0.5);
\node[anchor=center] (text) at (-8.5,-6) {\tiny $\edge^{out}_2$};

\draw[dashed] (-10,-5) rectangle (-13,-3); 
\node[anchor=center] (text) at (-11.5,-4) {\small $\ones$};

\draw[<-]  (-10.5,-5)--(-10.5,-7) node[midway,left] {\tiny $\cdots$}; 
\draw[<-]  (-12.5,-5)--(-12.5,-7);

\draw (-17.5,-7) rectangle (-9.5,-9);
\node[anchor=center] (text) at (-13.5,-8) {\small $\hypercoreof{\edge_2}$};
\draw[->]  (-11.5,-11)--(-11.5,-9) node[midway,left] {\tiny $\cdots$}; 
\draw[->]  (-14.5,-11)--(-14.5,-9);

\draw (-13,-10) ellipse (2 and 0.5);
\node[anchor=center] (text) at (-16,-10) {\tiny $\edge^{in}_2$};

\draw[dashed] (-15.5,-11) rectangle (-10.5,-13); 
\node[anchor=center] (text) at (-13,-12) {\small $\onehotmapof{\seccatindex}$};


\node[anchor=center] (text) at (-6,-2) {${=}$};

\node[anchor=center] (text) at (13,-2) {${=} \quad\quad 1 \, \, . $};



\begin{scope}[shift={(21,0)}]

\draw[dashed] (-22,1) rectangle (-14,3); 
\node[anchor=center] (text) at (-18,2) {\small $\ones$};

\draw[->]  (-21,-1)--(-21,1);% node[midway,left] {\tiny $\node_1$}; 
\draw[->]  (-15,-1)--(-15,1);% node[midway,left] {\tiny $\cdots \quad \edge^{out}_1$}; 
\node[anchor=center] (text) at (-18,0) {\small $\cdots$};


\draw (-18,0) ellipse (4 and 0.5);
\node[anchor=center] (text) at (-23,0) {\tiny $\edge^{out}_1$};

\draw (-22,-1) rectangle (-14,-3);
\node[anchor=center] (text) at (-18,-2) {\small $\hypercoreof{\edge_1}$};
\draw[<-]  (-21,-3)--(-21,-5);% node[midway,left]% {\tiny $\node_1$}; 
\draw[<-]  (-19,-3)--(-19,-5) node[midway,left] {\tiny $\cdots$}; 

\draw[<-]  (-17,-3)--(-17,-5);% node[midway,left] {\tiny $\exrandom$}; 
\draw[<-]  (-15,-3)--(-15,-5) node[midway,left] {\tiny $\cdots$};% node[midway,left] {\tiny $\exrandom$}; 


\draw (-18,-4) ellipse (4 and 0.5);
\node[anchor=center] (text) at (-23,-4) {\tiny $\edge^{in}_1$};


\draw[dashed] (-14,-5) rectangle (-17.5,-7); 
\node[anchor=center] (text) at (-15.75,-6) {\small $\tilde{\probtensor}$};


\draw[dashed] (-18.5,-5) rectangle (-22,-7); 
\node[anchor=center] (text) at (-20.25,-6) {\small $\onehotmapof{\catindex}$};


\end{scope}





\end{tikzpicture}