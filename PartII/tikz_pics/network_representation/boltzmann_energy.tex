\begin{tikzpicture}[thick, scale=0.35] % , baseline = -3.5pt

\drawatomindices{0}{-4}
\draw (-1,1) rectangle (5, -3);
\node[anchor=center] (text) at (2,-1) {$\sencodingof{\formulaset}$};

%\draw[->] (2,-1)--(2,1) node[midway,right] {\tiny ${\atomicformulaof{\selindexof{1}} \land \atomicformulaof{\selindexof{2}}}$};

\draw[<-] (5,0.5) -- (7,0.5) node[midway, above] {\tiny $\selvariableof{\cselectionsymbol}$};
\draw[<-] (5,-1)--(7,-1) node[midway,above] {\tiny $\selvariableof{\vselectionsymbol,1}$}; 
\draw[<-] (5,-2.5)--(7,-2.5) node[midway,below] {\tiny $\selvariableof{\vselectionsymbol,0}$}; 

\draw (7,1) rectangle (9, -3);
\node[anchor=center] (text) at (8,-1) {$\canparam$};


		
\node[anchor=center] (text) at (12,-2) {${=}$};


\begin{scope}[shift={(17,8)}]

% SkeletonCores

%% Would be required to match the formula tensor example, but would get messy!

%\drawatomindices{0}{0}
%\draw (-1,-1) rectangle (5, -3);
%\node[anchor=center] (text) at (1.5,-2) {$\skeleton^{\land}$};
%\drawatomindices{0}{-4}


%\drawatomindices{7}{0}
%\draw (6,-1) rectangle (12, -3);
%\node[anchor=center] (text) at (9,-2) {$\skeleton^{\lnot}$};
%\drawatomindices{7}{-4}

%\drawatomindices{3.5}{-4}	
%\draw (-1,-5) rectangle (12,-7);
%\node[anchor=center] (text) at (5.5,-6) {$\skeletoncoreof{\land}$};
%\drawatomindices{0}{-8}	
%\drawatomindices{7}{-8}	


	\begin{scope}[shift={(0,-10)}]
	
		\draw (4.5,7) rectangle (6.5, 9);	
		\node[anchor=center] (text) at (5.5,8) {$\onehotmapof{1}$};
		
		\draw[->] (5.5,5) -- (5.5,7) node[midway, right] {\tiny $\headvariableof{\lneuron}$};
		\draw (1,3) rectangle (10, 5);
		\node[anchor=center] (text) at (5.5,4) {$\rencodingof{\{\eqbincon,\lpasbincon \}}$};
		\draw (10,4) -- (12,4);
		\draw[<-] (12,4) -- (14,4) node[midway, above] {\tiny $\selvariableof{\cselectionsymbol}$};
			
		% SelectorCores
		\draw[->] (2,1) -- (2,3) node[midway, left] {\tiny $\headvariableof{\vselectionsymbol,0}$};
		\draw (-1,1) rectangle (5, -1);
		\node[anchor=center] (text) at (2,0) {$\selectorcoreof{1}$};
		\draw (5,0) -- (12,0);
		\draw[<-] (12,0) -- (14,0) node[midway, above] {\tiny $\selvariableof{\vselectionsymbol,1}$};
		\begin{scope}[shift={(0,-2)}]
			\draw[<-] (0,1)--(0,-3) node[midway,left] {\tiny $\catvariableof{0}$}; 
			\draw[<-] (1.5,1)--(1.5,-3) node[midway,left] {\tiny $\catvariableof{1}$}; 
			\node[anchor=center] (text) at (3,0) {$\cdots$};
			\draw[<-] (4,1)--(4,-3) node[midway,right] {\tiny $\catvariableof{\atomorder\shortminus1}$}; 
		\end{scope}


		\draw (9,-1) -- (9,1);
		\draw[->] (9,1) -- (9,3) node[midway, left] {\tiny $\headvariableof{\vselectionsymbol,1}$};
		\draw (6,-3) rectangle (12, -1);
		\node[anchor=center] (text) at (9,-2) {$\selectorcoreof{0}$};
		\draw[<-] (12,-2) -- (14,-2) node[midway, above] {\tiny $\selvariableof{\vselectionsymbol,0}$};
		\drawatomindices{7}{-4}	
		
		% ParameterCores
		\draw (14,5) rectangle (16, -3);
		\node[anchor=center] (text) at (15,1) {$\canparam$};
		
		\begin{scope}[shift={(-3.5,8)}]
			\draw[fill] (7.5,-15) circle (0.25cm);
			\draw[] (7.5,-15) to[bend left=25] (3.5,-13);
			\draw[] (7.5,-15) to[bend right=25] (10.5,-13);

			\draw[fill] (9,-15.25) circle (0.25cm);
			\draw[] (9,-15.25) to[bend left=25] (5,-13);
			\draw[] (9,-15.25) to[bend right=25] (12,-13);

			\draw[fill] (11.5,-15) circle (0.25cm);
			\draw[] (11.5,-15) to[bend left=25] (7.5,-13);
			\draw[] (11.5,-15) to[bend right=25] (14.5,-13);

			\drawatomindices{7.5}{-16}

		\end{scope}
	
	\end{scope}

\end{scope}

\end{tikzpicture}